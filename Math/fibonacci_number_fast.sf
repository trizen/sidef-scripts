#!/usr/bin/ruby

# Daniel "Trizen" È˜uteu
# Date: 19 June 2018
# https://github.com/trizen

# A very efficient algorithm for computing the nth-Fibonacci number.

func fibonacci_number(n) {

    var (f, g)       = (0, 1)
    var (a, b, c, d) = (0, 1, 1, 1)

    loop {
        (f, g) = (f*a + g*c, f*b + g*d) if n.is_odd
        n >>= 1 || break
        (a, b, c, d) = (a*a + b*c, a*b + b*d, c*a + d*c, c*b + d*d)
    }

    return f
}

say fibonacci_number(100)       #=> 354224848179261915075
